<h1>Car Form Details</h1>

<div class="card">
  <div class="card-body">
    <h5 class="card-title"><%= @car_form.vehicle_type %> - <%= @car_form.vehicle_identification_number %></h5>
    <p class="card-text">
      <strong>City:</strong> <%= @car_form.city %><br>
      <strong>Address:</strong> <%= @car_form.address %><br>
      <strong>Phone Number:</strong> <%= @car_form.phone_number %><br>
      <strong>Email:</strong> <%= @car_form.email %><br>
      <strong>Vehicle Type:</strong> <%= @car_form.vehicle_type %><br>
      <strong>Vehicle Identification Number:</strong> <%= @car_form.vehicle_identification_number %><br>
      <strong>Describe:</strong> <%= @car_form.describe %><br>
      <strong>User ID:</strong> <%= @car_form.user_id %><br>

      <% if @car_form.quotations.present? %>
        <hr>
        <h5>Quotation Details</h5>
        <strong>Discount:</strong> <%# @car_form.quotation.discount %><br>
        
  <div>
    <% @car_form.quotations.each do |quotation| %>
      <% if quotation.approved? %>
        <p class="text-success">Approved</p>
      <% elsif quotation.approved_by_customer == nil %>
        <div class="btn-group">
          <%= button_to 'Approve',
              quotation_approval_and_rejection_path(quotation, approved: true),
              method: :put, class: 'btn btn-success mt-3 mr-3' %>
          <%= button_to 'Reject',
              quotation_approval_and_rejection_path(quotation),
              method: :put, class: 'btn btn-danger m-3' %>
        </div>
      <% else %>
        <p class="text-danger">Rejected</p>
      <% end %>
    <% end %>
  </div>
      <% else %>
        <p>No quotation associated with this car form.</p>
      <% end %>
    </p>
  </div>
</div>


<div class="mt-3">
  <%= form_with(model: [@car_form, Quotation.new], url: car_form_comments_path(@car_form), method: :post) do |form| %>

    <div class="form-group">
      <%= form.fields_for :comments, Comment.new do |comment| %>
        <%= comment.label :content, 'Comment:' %>
        <%= comment.text_area :content, class: 'form-control', rows: 3 %>
      <% end %>
    </div>

    <%= form.submit 'Submit Comment', class: 'btn btn-primary' %>
  <% end %>

  <% if @car_form.comments.any? %>
    <hr>
    <h5>Comments</h5>
    <ul>
      <% @car_form.comments.each do |comment| %>
        <p><%= comment.content %></p>
      <% end %>
    </ul>
  <% else %>
    <p>No comments for this car form.</p>
  <% end %>
</div>
<%= link_to 'Back', user_car_forms_car_forms_path, class: 'btn btn-secondary mt-3' %>
